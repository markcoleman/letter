<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Generate DOGE Letters</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Google Fonts for modern typography -->
  <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" rel="stylesheet">
  <!-- Link to external CSS -->
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <!-- Hero Section -->
  <div class="hero">
    <h1>Generate DOGE Letters</h1>
  </div>

  <!-- Main Content Container -->
  <div class="container">
    <form id="infoForm">
      <div class="full-width">
        <label for="yourName">Your Name:</label>
        <input type="text" id="yourName" required>
      </div>
      <div class="full-width">
        <label for="streetAddress">Street Address:</label>
        <!-- Visible field with Google Places autocomplete -->
        <input type="text" id="streetAddress" placeholder="Start typing your street address" required>
      </div>
      <!-- Hidden fields for individual address components -->
      <input type="hidden" id="streetNumber">
      <input type="hidden" id="route">
      <input type="hidden" id="city">
      <input type="hidden" id="state">
      <input type="hidden" id="zip">
      <div class="half-width">
        <label for="yourEmail">Your Email:</label>
        <input type="email" id="yourEmail" required>
      </div>
      <div class="half-width">
        <label for="yourPhone">Your Phone Number:</label>
        <input type="text" id="yourPhone" required>
      </div>
      <div class="full-width">
        <label for="yourDate">Date:</label>
        <!-- Date input that will default to the local date -->
        <input type="date" id="yourDate" required>
      </div>
      <!-- Advanced Options Toggle -->
      <div class="full-width" style="text-align: center;">
        <button type="button" id="advancedOptionsToggle" onclick="toggleAdvancedOptions()">Show Advanced Options</button>
      </div>
      <!-- Advanced Options Section -->
      <div id="advancedOptions" class="full-width">
        <label for="customLetterBody">Custom Letter Body Content (Advanced):</label>
        <textarea id="customLetterBody"></textarea>
      </div>
      <div class="full-width" style="text-align: center;">
        <button type="button" onclick="generateLetters()">Generate Letters</button>
      </div>
    </form>

    <!-- Print Button -->
    <div style="text-align: center;">
      <button id="printButton" type="button" onclick="window.print()">Print Letters</button>
    </div>

    <!-- Container for the generated letters -->
    <div id="lettersContainer"></div>
  </div>

  <!-- Load the API key configuration -->
  <script src="config.js"></script>
  <!-- Dynamically load the Google Places API using the API key from config.js -->
  <script>
    function loadGoogleMapsAPI() {
      const script = document.createElement('script');
      script.src = "https://maps.googleapis.com/maps/api/js?key=" + GOOGLE_API_KEY + "&libraries=places&callback=initAutocomplete";
      script.async = true;
      script.defer = true;
      document.head.appendChild(script);
    }
    loadGoogleMapsAPI();
  </script>

  <!-- JavaScript for autocomplete, toggling advanced options, and letter generation -->
  <script>
    // Define the default custom letter body content.
    const defaultCustomBody = `
<p>
  I am writing as a concerned constituent regarding the Department of Government Efficiency (DOGE). Although DOGE was established by executive order with the aims of reducing wasteful spending, eliminating unnecessary regulations, and "modernizing federal technology and software to maximize governmental efficiency and productivity," it now appears to be run chaotically without regard to established process. This mismanagement is causing significant disruptions.
</p>
<p>My concerns include:</p>
<ul>
  <li><strong>Lack of Process and Oversight:</strong> The disorganized management of DOGE risks undermining its stated mission. Rather than streamlining government functions, its chaotic operation may lead to significant service disruptions.</li>
  <li><strong>Impact on Essential Services:</strong> Without clear processes and accountability, mismanagement could jeopardize the delivery of critical government services and public safety.</li>
  <li><strong>Need for Transparent Oversight:</strong> It is imperative that any effort to reform government operations be executed with full transparency and strict adherence to process.</li>
</ul>
<p>
  I respectfully urge you to call for a comprehensive review of DOGE’s management practices and to advocate for reforms that restore order, accountability, and continuity in government services.
</p>
<p>
  Thank you for your attention to this urgent matter. I look forward to your response regarding the steps you plan to take.
</p>
    `;

    // When the page loads, set the default values.
    window.addEventListener('DOMContentLoaded', () => {
      // Set the default date to the local date.
      document.getElementById('yourDate').value = getLocalDateString();
      // Populate the custom letter body textarea with default content.
      document.getElementById('customLetterBody').value = defaultCustomBody.trim();
    });

    // Helper function to get the local date formatted as YYYY-MM-DD.
    function getLocalDateString() {
      const today = new Date();
      const year = today.getFullYear();
      let month = today.getMonth() + 1;
      let day = today.getDate();
      // Pad month and day with leading zeros if needed.
      month = month < 10 ? '0' + month : month;
      day = day < 10 ? '0' + day : day;
      return `${year}-${month}-${day}`;
    }

    // Toggle the Advanced Options section.
    function toggleAdvancedOptions() {
      const advDiv = document.getElementById('advancedOptions');
      const toggleBtn = document.getElementById('advancedOptionsToggle');
      if (advDiv.style.display === "none" || advDiv.style.display === "") {
        advDiv.style.display = "block";
        toggleBtn.textContent = "Hide Advanced Options";
      } else {
        advDiv.style.display = "none";
        toggleBtn.textContent = "Show Advanced Options";
      }
    }

    // Initialize Google Places Autocomplete for the street address field.
    function initAutocomplete() {
      const streetAddressInput = document.getElementById('streetAddress');
      const autocomplete = new google.maps.places.Autocomplete(streetAddressInput, {
        types: ['address'],
        componentRestrictions: { country: 'us' }
      });
      
      autocomplete.addListener('place_changed', function() {
        const place = autocomplete.getPlace();
        let streetNumber = '';
        let route = '';
        let city = '';
        let state = '';
        let zip = '';

        // Extract address components.
        for (const component of place.address_components) {
          const types = component.types;
          if (types.indexOf('street_number') > -1) {
            streetNumber = component.long_name;
          }
          if (types.indexOf('route') > -1) {
            route = component.long_name;
          }
          if (types.indexOf('locality') > -1) {
            city = component.long_name;
          }
          if (types.indexOf('administrative_area_level_1') > -1) {
            state = component.short_name;
          }
          if (types.indexOf('postal_code') > -1) {
            zip = component.long_name;
          }
        }
        // Store extracted values in hidden inputs.
        document.getElementById('streetNumber').value = streetNumber;
        document.getElementById('route').value = route;
        document.getElementById('city').value = city;
        document.getElementById('state').value = state;
        document.getElementById('zip').value = zip;
      });
    }

    // Generate letters by iterating over a list of representatives.
    function generateLetters() {
      // Retrieve form values.
      const name = document.getElementById('yourName').value;
      const streetAddress = document.getElementById('streetAddress').value;
      const streetNumber = document.getElementById('streetNumber').value;
      const route = document.getElementById('route').value;
      const city = document.getElementById('city').value;
      const state = document.getElementById('state').value;
      const zip = document.getElementById('zip').value;
      const email = document.getElementById('yourEmail').value;
      const phone = document.getElementById('yourPhone').value;
      const date = document.getElementById('yourDate').value;
      
      // Combine address components.
      const fullStreet = (streetNumber && route) ? `${streetNumber} ${route}` : streetAddress;
      const fullAddress = `${fullStreet}<br>${city}, ${state} ${zip}`;
      
      // Get the advanced custom letter body; if empty, use the default.
      let customBody = document.getElementById('customLetterBody').value.trim();
      if (!customBody) {
        customBody = defaultCustomBody;
      }
      
      // Define an array of representative objects.
      const reps = [
        {
          id: "scot-perry",
          title: "Letter – To U.S. House, Rep. Scot Perry (District 10)",
          recipientHTML: "The Honorable Scot Perry<br>4999 Louise Drive, Suite 205<br>Mechanicsburg, PA 17055<br>Phone: 717-550-6565",
          subject: "Concern Over Chaotic Management of DOGE (Department of Government Efficiency)",
          greeting: "Dear Representative Perry,"
        },
        {
          id: "dawn-keefer",
          title: "Letter – To Senator Dawn Keefer",
          recipientHTML: "<strong>Option 1 – Official Senate Address:</strong><br>Senator Dawn Keefer<br>Senate Box 203031<br>Harrisburg, PA 17120-3031<br>Room: 168 Main Capitol<br>Phone: (717) 787-8524<br>FAX: (717) 782-2920<br><br><strong>Option 2 – Dillsburg Office Address:</strong><br>Senator Dawn Keefer<br>12 North Baltimore Street<br>Dillsburg, PA 17019<br>Phone: (717) 432-1730<br>FAX: (717) 432-1733",
          subject: "Request for Oversight on the Chaotic Implementation of DOGE (Department of Government Efficiency)",
          greeting: "Dear Senator Keefer,"
        },
        {
          id: "marc-anderson",
          title: "Letter – To Hon. Marc S. Anderson",
          recipientHTML: "<strong>Option 1 – Dillsburg Office Address:</strong><br>Hon. Marc S. Anderson<br>1 East Harrisburg Street<br>Dillsburg, PA 17019<br>Phone: (717) 432-0792<br>Toll Free: (833) 933-2965<br>Fax: (717) 432-0795<br><br><strong>Option 2 – Capitol Address:</strong><br>Hon. Marc S. Anderson<br>428 Irvis Office Building<br>P.O. Box 202092<br>Harrisburg, PA 17120-2092<br>Phone: (717) 783-8783<br>Fax: (717) 782-2920",
          subject: "Concern Over the Chaotic Operation of DOGE (Department of Government Efficiency)",
          greeting: "Dear Representative Anderson,"
        },
        {
          id: "john-fetterman",
          title: "Letter – To U.S. Senate, Sen. John Fetterman",
          recipientHTML: "Senator John Fetterman<br>142 Russell Senate Office Building<br>Washington, DC 20510<br>Phone: (202) 224-4254",
          subject: "Request for Enhanced Oversight on the Chaotic Management of DOGE (Department of Government Efficiency)",
          greeting: "Dear Senator Fetterman,"
        },
        {
          id: "david-mccormick",
          title: "Letter – To U.S. Senate, Sen. David McCormick",
          recipientHTML: "Senator David McCormick<br>B40C Dirksen Senate Office Building<br>Washington, DC 20510",
          subject: "Concern Over the Chaotic Management of DOGE (Department of Government Efficiency)",
          greeting: "Dear Senator McCormick,"
        }
      ];
      
      // Build the letters by iterating over the reps array.
      let allLettersHTML = "";
      reps.forEach(rep => {
        allLettersHTML += `
          <div class="letter" id="${rep.id}">
            <h2>${rep.title}</h2>
            <p>
              ${name}<br>
              ${fullAddress}<br>
              ${email}<br>
              ${phone}
            </p>
            <p>${date}</p>
            <p>${rep.recipientHTML}</p>
            <p><strong>Subject: ${rep.subject}</strong></p>
            <p>${rep.greeting}</p>
            ${customBody}
            <p>Sincerely,<br>${name}</p>
          </div>
        `;
      });
      
      // Insert the generated letters into the page.
      document.getElementById('lettersContainer').innerHTML = allLettersHTML;
    }
  </script>

</body>
</html>